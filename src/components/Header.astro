---
import ArrowRight from "@/icons/ArrowRight.astro";
import ThreeDots from "@/icons/ThreeDots.astro";
import Section from "@/layouts/Section.astro";
---

<Section class="fixed top-0 z-10">
  <header class="flex h-24 items-center justify-between">
    <a class="cursor-pointer text-3xl font-extrabold" id="logo">spm</a>

    <nav
      class="hidden rounded-xl bg-gray-200/60 px-8 py-3 backdrop-blur-sm md:block"
      id="nav"
    >
      <ul class="flex gap-10">
        <li class="group relative cursor-pointer">
          <a class="text-lg" href="#about">About</a>

          <div
            class="absolute bottom-0 left-0 h-[1px] w-0 bg-black transition-[width] duration-300 group-hover:w-full"
          >
          </div>
        </li>

        <li class="group relative cursor-pointer">
          <a class="text-lg" href="#studies">Studies</a>

          <div
            class="absolute bottom-0 left-0 h-[1px] w-0 bg-black transition-[width] duration-300 group-hover:w-full"
          >
          </div>
        </li>

        <li class="group relative cursor-pointer">
          <a class="text-lg" href="#career">Career</a>

          <div
            class="absolute bottom-0 left-0 h-[1px] w-0 bg-black transition-[width] duration-300 group-hover:w-full"
          >
          </div>
        </li>
      </ul>
    </nav>

    <div class="flex gap-1 xs:gap-2" id="buttons">
      <a href="#contact">
        <button
          class="group flex items-center justify-center gap-2 rounded-3xl bg-gray-800 px-4 py-3 text-sm font-bold text-white transition-[filter] hover:brightness-125 xs:px-8 xs:text-base"
        >
          Contact

          <ArrowRight
            class="hidden w-5 fill-white transition-transform group-hover:translate-x-1.5 md:block"
          />
        </button>
      </a>

      <button
        class="flex items-center justify-center rounded-3xl bg-gray-200 px-4 py-3 text-sm font-bold text-black transition-[filter] hover:brightness-95 xs:px-8 xs:text-base md:hidden"
        id="responsive-menu-button"
      >
        <span class="hidden xs:block">Menu</span>

        <ThreeDots class="w-5 fill-black xs:hidden" />
      </button>
    </div>

    <div
      class="absolute left-0 top-0 z-20 hidden h-screen w-screen md:hidden"
      id="responsive-menu-block"
    >
      <div
        class="min-w-20 bg-black opacity-0 xs:min-w-36"
        id="responsive-menu-closer"
      >
      </div>

      <nav
        class="w-full bg-gray-200 pl-4 pt-4 xs:pl-8 xs:pt-8"
        id="responsive-menu-content"
      >
        <ul class="flex flex-col gap-1">
          <a class="text-3xl xs:text-4xl" href="#about">
            <li class="group relative cursor-pointer">
              About

              <div
                class="absolute bottom-0 left-0 h-[1px] w-0 bg-black transition-[width] duration-300 group-hover:w-full"
              >
              </div>
            </li>
          </a>

          <a class="text-3xl xs:text-4xl" href="#studies">
            <li class="group relative cursor-pointer">
              Studies

              <div
                class="absolute bottom-0 left-0 h-[1px] w-0 bg-black transition-[width] duration-300 group-hover:w-full"
              >
              </div>
            </li>
          </a>

          <a class="text-3xl xs:text-4xl" href="#career">
            <li class="group relative cursor-pointer">
              Career

              <div
                class="absolute bottom-0 left-0 h-[1px] w-0 bg-black transition-[width] duration-300 group-hover:w-full"
              >
              </div>
            </li>
          </a>
        </ul>
      </nav>
    </div>
  </header>
</Section>

<script>
  import gsap from "gsap";

  const logo = document.getElementById("logo") as HTMLAnchorElement;
  const nav = document.getElementById("nav") as HTMLDivElement;
  const buttons = document.getElementById("buttons") as HTMLDivElement;

  const responsiveMenuButton = document.getElementById(
    "responsive-menu-button"
  ) as HTMLButtonElement;

  const responsiveMenuBlock = document.getElementById(
    "responsive-menu-block"
  ) as HTMLDivElement;

  const responsiveMenuCloser = document.getElementById(
    "responsive-menu-closer"
  ) as HTMLDivElement;

  const responsiveMenuContent = document.getElementById(
    "responsive-menu-content"
  ) as HTMLDivElement;

  const responsiveMenuLinks = responsiveMenuContent.querySelectorAll(
    "a"
  ) as NodeListOf<HTMLAnchorElement>;

  /**
   * Show the responsive menu
   */
  const showResponsiveMenu = () => {
    responsiveMenuBlock.classList.replace("hidden", "flex");

    gsap.fromTo(
      responsiveMenuContent,
      { x: "100%" },
      {
        x: 0,
        duration: 0.5,
        ease: "power2.out",
        onComplete: () => {
          gsap.fromTo(
            responsiveMenuCloser,
            { opacity: 0 },
            { opacity: "80%", duration: 0.25, ease: "power2.out" }
          );
        },
      }
    );
  };

  /**
   * Hide the responsive menu
   */
  const hideResponsiveMenu = () => {
    gsap.fromTo(
      responsiveMenuCloser,
      { opacity: "100%" },
      {
        opacity: "0%",
        duration: 0,
        ease: "power2.out",
        onComplete: () => {
          gsap
            .fromTo(
              responsiveMenuContent,
              { x: 0 },
              { x: "100%", duration: 0.5, ease: "power2.out" }
            )
            .then(() => {
              responsiveMenuBlock.classList.replace("flex", "hidden");
            });
        },
      }
    );
  };

  gsap.fromTo(
    logo,
    { opacity: 0, y: -50 },
    { opacity: 1, y: 0, duration: 0.5, ease: "power2.out" }
  );

  gsap.fromTo(
    nav,
    { opacity: 0, y: -50 },
    { opacity: 1, y: 0, duration: 0.5, delay: 0.1, ease: "power2.out" }
  );

  gsap.fromTo(
    buttons,
    { opacity: 0, y: -50 },
    { opacity: 1, y: 0, duration: 0.5, delay: 0.2, ease: "power2.out" }
  );

  responsiveMenuButton.addEventListener("click", () => {
    showResponsiveMenu();
  });

  responsiveMenuCloser.addEventListener("click", () => {
    hideResponsiveMenu();
  });

  responsiveMenuLinks.forEach((item) => {
    item.addEventListener("click", () => {
      hideResponsiveMenu();
    });
  });
</script>
